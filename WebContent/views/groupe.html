<div class="center-div">

	<div class="bottom-space title-page">
		<h1>
			<i class="fa fa-user logo-titre"></i>
			<!--   "editable-text" ajoute ses class "à lui", donc le ng-class est overridé ici -->
			<span ng-if="constitutionGroupe.admin" editable-text="constitutionGroupe.groupe.nom" onaftersave="updateGroupe()">
				{{constitutionGroupe.groupe.nom}}
			</span>
			<span ng-if="!constitutionGroupe.admin">
		 		<b>{{constitutionGroupe.groupe.nom}}</b>
		 	</span>
		</h1>
	</div>
	<div class="bottom-space panel panel-info" >
		 <div class="panel-body message-groupe">
		 	<span ng-if="constitutionGroupe.admin"  editable-textarea="constitutionGroupe.groupe.message" onaftersave="updateGroupe()" >
		 		<b>{{constitutionGroupe.groupe.message}}</b> <!-- TODO Gérer les retours à lignes... -->
		 	</span>
		 	<span ng-if="!constitutionGroupe.admin" ng-show="constitutionGroupe.groupe.message">
		 		<b>{{constitutionGroupe.groupe.message}}</b> <!-- TODO Gérer les retours à lignes... -->
		 	</span>
		 </div>
	</div>

	<div class="bottom-space">
		Occurence : 
		<!-- Désactivé car pour le moment on ne veut pas éditer le jour d'occurence. --> 
		<a ng-if="constitutionGroupe.admin" href="#" editable-select="jourCourant.id" e-ng-options="jour.id as jour.nom for jour in jours" onaftersave="updateGroupe()">
		 {{ jourCourant.nom || 'not set' }} 
		</a> 
		<span >
			<b>{{ jours[jourCourant.id].nom }}</b>
		</span>
	</div>
	
	<h2>Cycle en cours
		<button ng-click="calculerCycle(constitutionGroupe.idGroupe)" class="btn btn-primary btn-sm"  data-toggle="tooltip" data-placement="right" title="Générer le cycle en cours" style="margin-left:10px;" ng-show="constitutionGroupe.admin">
			<i class="fa fa-refresh"></i>
		</button>
	</h2>
	
	
	<div ng-hide="tours" class="bottom-space">
		Aucun cycle trouvé.
	</div>
	
	<div ng-show="tours">
	
		<div class="table-responsive">
			<table class="table table-hover bottom-space">
				<thead>
					<tr>
						<th>Nom</th>
						<th>Date</th>
						<th ng-show="constitutionGroupe.admin"  style="text-align:right;">Actions</th>
					</tr>
				</thead>
				<tbody class="table-hover">
					<tr ng-repeat="tour in tours" ng-class="(tour.statutTour == 'ANNULE') ? 'danger' : ''">
						<td>{{tour.nomTour}}</td>
						<td>{{tour.dateTour | date : 'd MMM'}}</td>
						<td ng-show="constitutionGroupe.admin" style="text-align:right;width:100px;">
							<div>
								<button ng-class="$first ? 'disabled' : ''"  ng-click="switchTour(tour, tours[$index - 1 ])"  title="Permuter avec {{tours[$index - 1 ].nomTour}} !" 
								data-toggle="tooltip" data-placement="top" class="btn btn-primary btn-xs"><i class="fa fa-arrow-up"></i></button>
								<button ng-class="$last ? 'disabled' : ''"  ng-click="switchTour(tour, tours[$index + 1 ])"  title="Permuter avec {{tours[$index + 1 ].nomTour}} !" 
								data-toggle="tooltip" data-placement="top" class="btn btn-primary btn-xs"><i class="fa fa-arrow-down"></i></button>
								<button ng-class="(tour.statutTour == 'ANNULE') ? 'disabled' : ''" ng-click="annulerTour(tour)" title="Annuler le tour du {{tour.dateTour | date : 'd MMM'}}" 
								 data-toggle="tooltip" data-placement="top" class="btn btn-warning btn-xs"><i class="fa fa-times"></i></button>
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
	
	
	<div ng-show="constitutionGroupe.admin">
	
	
		<h2 class="bottom-space">Membres du groupe</h2>
		<div class="row">
			<div class="col-xs-2" style="margin-top:5px;"><b>Inviter</b></div>
			<div class="col-xs-8"> <input type="email" class="form-control pull-left" placeholder="Email" ng-model="invite" ></div>
			<div class="col-xs-2"><button class="btn btn-primary pull-right" ng-click="inviteUser()">Inviter</button></div>
		</div>
		<div class="row bottom-space">
		 	<div class=" col-xs-offset-2 col-xs-10  format-error-message" ng-show="inviteError">{{inviteError}} </div>
		 </div>
		
		<!-- Ne peut normalement être vide ? -->
		<div class="table-responsive">
			<table class="table table-hover bottom-space">
				<thead>
					<tr>
						<th style="width: 80%;">Nom</th>
						<th style="text-align:center;">Admin</th>
					</tr>
				</thead>
				<tbody class="table-hover">
					<tr ng-repeat="constit in constitutionsGroupe">
						<td>{{constit.utilisateur.nom}}</td>
						<td style="text-align:center;">
							<input type="checkbox" ng-model="constit.admin" ng-change="setAdministrateur(constit)"/>
							
						</td>
					</tr>
				</tbody>
		
			</table>
		</div>
		
		<div>
			Token du groupe : <b>{{constitutionGroupe.groupe.jeton}}</b>
		</div>
		<div>
			Mot de passe du groupe : <b>{{constitutionGroupe.groupe.motDePasse}}</b>
		</div>
		
	</div>
	
	
</div>